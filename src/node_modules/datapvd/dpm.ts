
import * as mods from 'mods';
import * as utility from 'utility';
import * as config from 'config';
import * as path from 'path';

function getRawData(target: string) {

}

function genRawDataHub(target:string):mods.Hub<{}>{
    return new mods.Hub<{}>(()=>{
        (config.useLocalRaw?utility.file.loadJsonFile(path.join(config.rawDataFolder, `${target}.json`)):)
    })
}

function retrieve(target: string): CachedItem {
    var incache = findCache(target);
    if (incache == null) {
        incache.lastAccessTs = new Date().getTime();
        return incache;
    }
    else {
        var src = { target: target, rawHub: null };
    }
}

interface CachedItem {
    target: string,
    rawHub: mods.Hub<{}>,
    permanent: boolean,
    lastAccessTs: number
}
var srcCache = new Array<CachedItem>();
function findCache(target: string): CachedItem {
    return utility.array.findFirst(srcCache, x => x.target === target, null);
}
